<div class="popup" id="new-topic" style="display:none">
    <div id="around" onclick="hideDiag()">
    </div>
    <div id="dialog">
        <h1>Create topic</h1>
        <form action="../../backend/create.php" method="post" target="_blank">
            <!--Changing these values won't bypass security, it will just make you post somewhere else (or not at all)-->
            <input type="hidden" name="mode" value="topic"/>
            <input type="hidden" name="level" value="<?php echo $_GET['lv']?>"/>
            <input type="hidden" name="task" value="<?php echo $_GET['task']?>"/>

            <label>Title <input type="text" name="title" placeholder="The title for the topic"/></label>
            <br/> <br/>

            <label>
                Text<br/>
                <textarea id="text" name="text" rows="15" oninput="preview(this)"></textarea>
            </label>

            <div id="preview">


            </div>
            <button class="button active" type="submit" onclick="location.reload()">Submit</button>
            <button class="button active" type="button" onclick = "hideDiag('new-topic')">Cancel</button>
        </form>

    </div>

    <script>
        function showDiag(id) {
            document.getElementById(id).style.display="block";
        }
        function hideDiag(id){
            document.getElementById(id).style.display="none";
        }

        function preview(element) {
            console.log("update");
            let val = element.value.replace(/\n/g, "<br/>").replace(/<script/g, "&lt;script").replace(/<\/script/g, "&lt;/script");
            console.log(val);
            element.parentElement.nextElementSibling.innerHTML = val;
        }
    </script>

</div>
